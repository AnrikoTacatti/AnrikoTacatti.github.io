var gulp=require("gulp"),browserSync=require("browser-sync").create(),pug=require("gulp-pug"),sass=require("gulp-sass"),autoprefixer=require("gulp-autoprefixer"),spritesmith=require("gulp.spritesmith"),rimraf=require("rimraf"),rename=require("gulp-rename"),uglify=require("gulp-uglifyjs"),concat=require("gulp-concat"),sourcemaps=require("gulp-sourcemaps");gulp.task("js",function(){return gulp.src(["source/js/main.js"]).pipe(sourcemaps.init()).pipe(concat("main.min.js")).pipe(sourcemaps.write()).pipe(gulp.dest("build/js"))}),gulp.task("server",function(){browserSync.init({server:{port:9e3,baseDir:"build"}}),gulp.watch("build/**/*").on("change",browserSync.reload)}),gulp.task("templates:compile",function(){return gulp.src("source/template/index.pug").pipe(pug({pretty:!0})).pipe(gulp.dest("build"))}),gulp.task("styles:compile",function(){return gulp.src("source/styles/main.scss").pipe(sass({outputStyle:"compressed"}).on("error",sass.logError)).pipe(autoprefixer({browsers:["last 4 versions"],cascade:!1})).pipe(rename("main.min.css")).pipe(gulp.dest("build/css"))}),gulp.task("sass:watch",function(){gulp.watch("./sass/**/*.scss",["sass"])}),gulp.task("sprite",function(s){var e=gulp.src("sorse/images/icons/*.png").pipe(spritesmith({imgName:"sprite.png",imgPath:"../images/sprite.png",cssName:"sprite.scss"}));e.img.pipe(gulp.dest("build/images/")),e.css.pipe(gulp.dest("source/styles/global/")),s()}),gulp.task("clean",function(s){return rimraf("build",s)}),gulp.task("copy:fonts",function(){return gulp.src("source/fonts/*.*").pipe(gulp.dest("build/fonts"))}),gulp.task("copy:images",function(){return gulp.src("source/images/*.*").pipe(gulp.dest("build/images"))}),gulp.task("copy",gulp.parallel("copy:fonts","copy:images")),gulp.task("watch",function(){gulp.watch("source/template/**/*.pug",gulp.series("templates:compile")),gulp.watch("source/styles/**/*.scss",gulp.series("styles:compile")),gulp.watch("source/js/**/*.js",gulp.series("js"))}),gulp.task("default",gulp.series("clean",gulp.parallel("templates:compile","styles:compile","js","sprite","copy"),gulp.parallel("watch","server")));